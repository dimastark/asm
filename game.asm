.model tiny
.code
.386
org 100h

start:
  mov ax, 13h
  int 10h
  mov ax, 0A000h
  mov es, ax

  call intro
  call wait_select
  cmp [option], 1
  jne end_game

  lea bx, lvl_start
  call mov_sound_nums
  call play_sound

  end_game:
  mov ah, 4ch
  int 21h
  ret

; ------- SPRITES FUNCTIONS -------

  ; bx - sprite addr
  x dw 0  ; x coordinate
  y dw 0  ; y coordinate
  w dw 0  ; width
  h dw 0  ; height
  f dw 0  ; first shift
  draw_pixels proc
    mov ax, [y]
    mov cx, 320
    mul cx
    add ax, [x]
    mov di, ax
    mov si, [f]
    mov cx, [h]
    lines:
      push cx
      mov cx, [w]
      columns:
        mov al, [bx][si]
        inc si
        stosb
      loop columns
      pop cx
      add di, 320
      sub di, [w]
    loop lines
    ret
  endp draw_pixels

  xc dw 0  ; x coordinate
  yc dw 0  ; y coordinate
  wc dw 0  ; width
  hc dw 0  ; height
  cc db 0  ; color for clean
  clear_pixels proc
    mov ax, [yc]
    mov cx, 320
    mul cx
    add ax, [xc]
    mov di, ax
    mov cx, [hc]
    linesс:
      push cx
      mov cx, [wc]
      columnsс:
        mov al, [cc]
        stosb
      loop columnsс
      pop cx
      add di, 320
      sub di, [wc]
    loop linesс
    ret
  endp clear_pixels

  ; bx - sprite nums addr
  mov_sprite_nums proc
    mov ax, word ptr [bx]
    mov [w], ax
    mov ax, word ptr [bx+2]
    mov [h], ax
    ret
  endp mov_sprite_nums

  clear_sprite_nums proc
    mov [w], 0
    mov [h], 0
    mov [x], 0
    mov [y], 0
    mov [f], 0
    ret
  endp clear_sprite_nums

; ------- MUSIC FUNCTIONS -------

  b_port = 61h
  cmdreg = 43h
  latch2 = 42h

  init_sound proc
    in al, b_port
    or al, 00000011b
    out b_port, al
    ret
  endp init_sound

  term_sound proc
    in al, b_port
    and al, 0fch
    out b_port, al
    ret
  endp term_sound
  
  melody dw 0 ; melody for playing
  beat dw 0   ; beats for playing
  play_sound proc
    xor si, si
    mov al, 0b6h
    out cmdreg, al

    next_note:
      call term_sound

      mov bx, [melody]
      mov al, [bx][si] 
      cmp al, 0
      je delay_loop
      cmp al, 0ffh
      je end_sound
      cbw

      lea bx, frequency
      shl ax, 1 
      mov di, ax
      mov dx, [bx][di]
     
      call init_sound
      mov al, dl 
      out latch2, al
      mov al, dh
      out latch2, al

      delay_loop:
      mov ah, 0
      int 1ah

      mov bx, [beat]
      cmp bx, 0
      je next_note

      mov cl, [bx][si]
      mov ch, 0
      mov bx, dx
      add bx, cx
      sound: 
        int 1ah
        cmp dx, bx
      jne sound
      inc si
      jmp next_note

    end_sound:
    call term_sound
    ret
  endp play_sound

  ; bx - meta for sound
  mov_sound_nums proc
    mov ax, [bx]
    mov [beat], ax
    mov ax, [bx+2]
    mov [melody], ax
    ret
  endp mov_sound_nums

  ;               C(до)  C#   D(ре)  D#   E(ми) F(фа)  F#   G(со)  G#   A(ля)  A#   B(си)
  frequency dw 0, 9121, 8609, 8126, 7670, 7239, 6833, 6449, 6087, 5746, 5423, 5119, 4831 ; малая
            dw    4560, 4304, 4063, 3834, 3619, 3416, 3224, 3043, 2873, 2711, 2559, 2415 ; 1
            dw    2280, 2152, 2031, 1917, 1809, 1715, 1612, 1521, 1436, 1355, 1292, 1207 ; 2
            dw    1140, 1076, 1015, 0958, 0904, 0857, 0806, 0760, 0718, 0677, 0646, 0603 ; 3

; ------- GAME FUNCTIONS -------

  intro proc
    lea bx, preview_nums
    call mov_sprite_nums
    lea bx, preview

    mov [h], 2
    mov [x], 66
    mov [f], 188*109

    intro_animation_1:
      call draw_pixels
      inc [h]
      sub [f], 188
      mov ah, 1
      int 16h
      jnz end_animation
      cmp [f], 0
    jne intro_animation_1

    mov [wc], 320
    mov [hc], 1

    intro_animation_2:
      call draw_pixels
      call clear_pixels
      inc [y]
      inc [hc]
      mov ah, 1
      int 16h
      jnz end_animation
      cmp [y], 30
    jne intro_animation_2
    ret

    end_animation:
    mov [wc], 320
    mov [hc], 200
    call clear_pixels

    mov [x], 66
    mov [y], 30
    mov [f], 0

    lea bx, preview_nums
    call mov_sprite_nums
    lea bx, preview
    call draw_pixels

    call clear_sprite_nums
    mov ax, 0
    int 16h
    ret
  endp intro

  ; 1 - 1 player, 2 - 2 players
  option db 0
  wait_select proc
    lea bx, playerr_nums
    call mov_sprite_nums
    mov [x], 105
    mov [xc], 105
    mov [wc], 13
    mov [hc], 13
    lea bx, playerr

    first_option:
      cmp [option], 1
      je wait_enter
      mov [option], 1
      mov [yc], 130
      call clear_pixels
      mov [y], 115
      call draw_pixels
      jmp wait_enter

    second_option:
      cmp [option], 2
      je wait_enter
      mov [option], 2
      mov [yc], 115
      call clear_pixels
      mov [y], 130
      call draw_pixels
      jmp wait_enter

    wait_enter:
      mov ax, 0
      int 16h
      cmp ah, 72
      je first_option
      cmp ah, 80
      je second_option
      cmp ah, 1
      je end_game
      cmp ah, 28
      jne wait_enter

    ret
  endp wait_select

; ------- SPRITES -------

  beated_flag db 21 dup (0),6,14 dup (0),6,6,0,22,12 dup (0),6,0,22,22,22,10 dup (0),6,0,5 dup (22),8 dup (0),6,6,0,8 dup (22)
              db 5 dup (0),6,0,10 dup (22),0,0,0,6,6,0,10 dup (22),0,0,0,6,0,0,8 dup (22),0,22,22,0,0,6,0,6 dup (22),0
              db 0,22,0,22,22,0,0,6,0,0,0,22,22,22,5 dup (0),22,0,0,0,6,5 dup (0),22,5 dup (0),22,0,0,0,6,15 dup (0),6
              db 15 dup (0),6,30 dup (0)
  beated_flag_nums dw 16, 16

  boom_1 db 39 dup (0),15,5 dup (0),15,5 dup (0),15,0,0,0,15,0,0,15,0,15,6 dup (0),34,15,15,0,34,15,0,15,15,34,7 dup (0)
         db 34,34,15,15,34,34,15,34,9 dup (0),34,15,4,15,4,15,34,15,15,5 dup (0),15,15,15,34,15,4,0,4,34,34,8 dup (0)
         db 34,15,0,4,4,15,34,9 dup (0),15,15,4,15,34,4,15,34,7 dup (0),15,34,0,15,34,15,15,34,15,34,5 dup (0),15
         db 34,0,34,15,0,34,15,0,0,15,8 dup (0),15,0,0,0,34,53 dup (0)
  boom_1_nums dw 16, 16

  boom_2 db 22 dup (0),34,0,0,0,15,6 dup (0),15,0,0,34,0,15,34,0,15,34,0,0,0,15,0,0,34,15,15,0,0,34,15,0,15,34,0
         db 15,15,34,0,0,0,34,34,15,34,34,15,15,15,34,15,34,34,5 dup (0),34,15,4,15,15,15,34,4,15,15,0,34,0,0,34
         db 0,0,34,15,4,0,4,15,15,34,34,6 dup (0),15,15,15,15,4,4,4,0,34,15,15,15,0,15,15,0,15,34,15,0,4,4,0,15,15
         db 34,34,0,0,0,0,34,34,15,15,34,4,4,4,15,34,34,0,34,5 dup (0),15,4,15,34,0,34,15,4,15,5 dup (0),34,0,34
         db 15,4,15,15,15,4,34,15,15,5 dup (0),34,15,34,15,34,34,15,15,0,34,34,15,0,0,0,0,15,34,34,15,34,0,34,15
         db 0,0,0,34,0,0,0,15,34,0,0,15,0,34,0,34,34,20 dup (0)
  boom_2_nums dw 16, 16

  boom_3 db 0,0,0,0,34,0,34,0,0,0,0,34,0,0,34,0,0,15,0,0,0,15,0,0,15,0,34,0,0,15,34,0,0,34,34,15,15,0,0,15,15,0,0
         db 0,15,34,0,0,0,0,34,34,15,34,34,15,34,34,0,15,15,34,5 dup (0),34,4,15,15,15,15,34,15,15,34,34,0,34,0,15
         db 0,34,15,15,4,15,0,15,15,4,34,5 dup (0),34,15,15,4,34,4,4,0,4,34,15,34,0,0,15,15,15,15,0,15,4,0,0,4,6 dup (15)
         db 0,34,34,34,15,15,34,4,0,4,15,34,34,34,5 dup (0),34,34,34,0,15,4,0,34,34,15,15,0,0,0,15,34,34,15,15,34
         db 15,0,15,4,15,34,34,15,0,0,0,15,15,15,4,15,34,15,34,15,15,5 dup (0),34,15,34,34,15,34,15,15,34,34,15,15
         db 0,34,0,0,15,34,0,0,34,0,34,15,34,0,34,34,15,0,0,15,34,0,0,34,0,0,0,15,0,0,0,0,34,15,9 dup (0),15,0,34
         db 0,0,0,34,1 dup (0)
  boom_3_nums dw 16, 16

  bricks db 102,102,102,102,22,7 dup (102),22,102,102,102,6,6,6,6,22,102,6 dup (6),22,102,6 dup (6),22,102,6 dup (6)
         db 22,102,6,6,17 dup (22),7 dup (102),22,7 dup (102),22,102,6 dup (6),22,102,6 dup (6),22,102,6 dup (6)
         db 22,102,6 dup (6),16 dup (22),102,102,102,102,22,7 dup (102),22,102,102,102,6,6,6,6,22,102,6 dup (6),22
         db 102,6 dup (6),22,102,6 dup (6),22,102,6,6,17 dup (22),7 dup (102),22,7 dup (102),22,102,6 dup (6),22
         db 102,6 dup (6),22,102,6 dup (6),22,102,6 dup (6),16 dup (22)
  bricks_nums dw 16, 16

  bulletd db 9 dup (25),0,25,1 dup (0)
  bulletd_nums dw 3, 4

  bulletl db 0,7 dup (25),0,3 dup (25)
  bulletl_nums dw 4, 3

  bulletr db 25,25,25,0,7 dup (25),1 dup (0)
  bulletr_nums dw 4, 3

  bulletu db 0,25,0,9 dup (25)
  bulletu_nums dw 3, 4

  evild db 34,4,4,7 dup (0),34,4,4,34,34,15,0,5 dup (15),0,34,34,34,15,4,15,4,15,4,4,4,4,34,34,4,4,34,34,15,15,4
        db 15,15,4,4,4,34,34,34,15,4,15,15,4,15,4,34,4,4,34,4,4,34,34,15,15,4,15,4,34,4,4,34,34,34,15,4,15,15,4
        db 4,34,34,4,4,34,4,4,34,34,15,15,15,4,4,4,4,34,34,34,34,15,4,15,0,34,34,15,34,34,0,34,4,4,34,34,15,0,0
        db 0,15,0,0,0,34,34,34,15,4,4,0,0,0,15,0,0,0,34,4,4,6 dup (0),15,12 dup (0),15,6 dup (0)
  evild_nums dw 13, 13

  evill db 0,0,11 dup (34),0,0,4,34,4,34,4,34,4,34,4,34,4,0,0,4,9 dup (15),34,5 dup (0),5 dup (15),34,6 dup (0)
        db 15,15,4,4,4,15,15,34,5 dup (0),4,4,15,15,15,4,15,34,0,5 dup (15),4,15,4,4,34,4,34,5 dup (0),34,4,4,34
        db 34,34,4,34,5 dup (0),34,5 dup (4),34,34,6 dup (0),6 dup (34),0,0,0,0,15,10 dup (34),0,0,4,34,4,34,4,34
        db 4,34,4,34,4,0,0,4,34,4,34,4,34,4,34,4,34,1 dup (4)
  evill_nums dw 13, 13

  evilr db 11 dup (34),0,0,4,34,4,34,4,34,4,34,4,34,4,0,0,4,9 dup (15),4,0,0,0,0,4,5 dup (15),6 dup (0),15,15,4
        db 4,4,4,15,34,5 dup (0),15,4,15,15,15,4,4,34,5 dup (0),4,4,15,4,4,34,4,5 dup (15),0,4,4,4,34,34,34,4,34
        db 5 dup (0),4,34,5 dup (4),34,6 dup (0),6 dup (34),5 dup (0),15,10 dup (34),0,0,4,34,4,34,4,34,4,34,4,34
        db 4,0,0,4,34,4,34,4,34,4,34,4,34,4,2 dup (0)
  evilr_nums dw 13, 13

  evilu db 6 dup (0),15,12 dup (0),15,6 dup (0),15,4,4,0,0,0,15,0,0,0,15,4,4,34,34,15,0,0,0,15,0,0,0,34,34,34,15
        db 4,15,0,15,4,15,34,34,0,34,4,4,34,34,15,15,15,4,4,4,4,34,34,34,34,15,4,15,15,4,15,15,4,4,4,34,4,4,34,34
        db 15,15,4,15,4,34,4,4,34,34,34,15,4,15,15,4,15,4,34,4,4,34,4,4,34,34,15,15,15,4,34,34,4,4,34,34,34,15,4
        db 15,34,15,15,4,4,4,34,34,4,4,34,34,15,0,5 dup (34),0,34,34,34,15,4,4,7 dup (0),34,2 dup (4)
  evilu_nums dw 13, 13

  flag db 16 dup (0),22,22,12 dup (0),22,22,0,22,22,0,0,0,22,22,22,0,0,0,0,22,22,0,22,22,22,22,0,0,0,22,102,22
       db 0,0,22,22,22,22,0,22,22,22,0,0,0,22,22,0,0,0,22,22,22,0,6 dup (22),0,22,22,0,6 dup (22),0,0,22,102,8 dup (22)
       db 102,22,0,0,0,22,22,22,102,6 dup (22),102,22,22,22,0,0,0,22,22,22,22,102,22,22,102,22,22,22,22,0,0,0,0
       db 12 dup (22),5 dup (0),22,22,22,0,22,22,0,22,22,22,10 dup (0),22,22,13 dup (0),22,22,22,22,10 dup (0)
       db 8 dup (22),8 dup (0),22,22,0,22,22,0,22,22,20 dup (0)
  flag_nums dw 16, 16

  game_over db 0,0,5 dup (4),0,0,0,4,4,4,0,0,0,4,4,0,0,0,4,4,0,0,6 dup (4),0,4,4,6 dup (0),4,4,0,4,4,0,0,4,4,4,0,4,4
            db 4,0,0,4,4,0,0,0,0,4,4,6 dup (0),4,4,0,0,0,4,4,0,7 dup (4),0,0,4,4,0,0,0,0,4,4,0,0,4,4,4,0,4,4,0,0,0,4
            db 4,0,7 dup (4),0,0,5 dup (4),0,4,4,0,0,0,4,4,0,7 dup (4),0,4,4,0,4,0,4,4,0,0,4,4,5 dup (0),4,4,0,0,4,4
            db 0,4,4,0,0,0,4,4,0,4,4,0,0,0,4,4,0,0,4,4,6 dup (0),5 dup (4),0,4,4,0,0,0,4,4,0,4,4,0,0,0,4,4,0,0,6 dup (4)
            db 32 dup (0),5 dup (4),0,0,4,4,0,0,0,4,4,0,0,6 dup (4),0,6 dup (4),0,4,4,0,0,0,4,4,0,4,4,0,0,0,4,4,0,0
            db 4,4,5 dup (0),4,4,0,0,0,4,4,4,4,0,0,0,4,4,0,4,4,0,0,0,4,4,0,0,4,4,5 dup (0),4,4,0,0,0,4,4,4,4,0,0,0,4
            db 4,0,4,4,4,0,4,4,4,0,0,5 dup (4),0,0,4,4,0,0,5 dup (4),0,0,0,4,4,0,0,5 dup (4),0,0,0,4,4,5 dup (0),5 dup (4)
            db 0,0,4,4,0,0,0,4,4,0,0,0,4,4,4,0,0,0,0,4,4,5 dup (0),4,4,0,4,4,4,0,0,5 dup (4),5 dup (0),4,5 dup (0),6 dup (4)
            db 0,4,4,0,0,3 dup (4)
  game_over_nums dw 31, 15

  grass db 0,5 dup (2),11,0,0,5 dup (2),11,0,2,2,2,11,2,11,2,11,2,2,2,11,2,11,2,11,5 dup (2),11,11,11,5 dup (2)
        db 11,11,11,2,2,2,11,11,2,2,11,2,2,2,11,11,2,2,11,2,2,11,2,11,11,11,2,2,2,11,2,11,11,11,2,2,2,2,5 dup (11)
        db 2,2,2,10 dup (11),2,7 dup (11),2,11,11,0,11,11,2,11,11,11,0,0,11,11,2,11,11,11,0,0,5 dup (2),11,0,0,5 dup (2)
        db 11,0,2,2,2,11,2,11,2,11,2,2,2,11,2,11,2,11,5 dup (2),11,11,11,5 dup (2),11,11,11,2,2,2,11,11,2,2,11,2
        db 2,2,11,11,2,2,11,2,2,11,2,11,11,11,2,2,2,11,2,11,11,11,2,2,2,2,5 dup (11),2,2,2,10 dup (11),2,7 dup (11)
        db 2,11,11,0,11,11,2,11,11,11,0,0,11,11,2,11,11,11,1 dup (0)
  grass_nums dw 16, 16

  metals db 23 dup (25),22,7 dup (25),22,25,25,15,15,15,15,22,22,25,25,15,15,15,15,22,22,25,25,15,15,15,15,22,22
         db 25,25,15,15,15,15,22,22,25,25,15,15,15,15,22,22,25,25,15,15,15,15,22,22,25,25,15,15,15,15,22,22,25,25
         db 15,15,15,15,22,22,25,25,6 dup (22),25,25,6 dup (22),25,7 dup (22),25,7 dup (22),23 dup (25),22,7 dup (25)
         db 22,25,25,15,15,15,15,22,22,25,25,15,15,15,15,22,22,25,25,15,15,15,15,22,22,25,25,15,15,15,15,22,22,25
         db 25,15,15,15,15,22,22,25,25,15,15,15,15,22,22,25,25,15,15,15,15,22,22,25,25,15,15,15,15,22,22,25,25,6 dup (22)
         db 25,25,6 dup (22),25,7 dup (22),25,7 dup (22)
  metals_nums dw 16, 16

  num_0 db 12 dup (22),0,0,0,5 dup (22),0,22,22,0,0,22,22,22,0,0,22,22,22,0,0,22,22,0,0,22,22,22,0,0,22,22,0,0,22
        db 22,22,0,0,22,22,22,0,0,22,22,0,5 dup (22),0,0,0,12 dup (22)
  num_0_nums dw 9, 9

  num_1 db 11 dup (22),0,0,5 dup (22),0,0,0,6 dup (22),0,0,6 dup (22),0,0,6 dup (22),0,0,6 dup (22),0,0,22,22,22
        db 22,6 dup (0),9 dup (22)
  num_1_nums dw 8, 9

  num_2 db 11 dup (22),5 dup (0),22,22,22,0,0,22,22,22,0,0,6 dup (22),0,0,0,22,22,22,22,0,0,0,0,22,22,22,22,0,0
        db 0,0,22,22,22,22,0,0,0,6 dup (22),7 dup (0),10 dup (22)
  num_2_nums dw 9, 9

  playerd db 191,191,191,7 dup (0),191,191,191,93,43,93,0,5 dup (93),0,191,43,43,191,191,93,43,93,43,43,43,43,191
          db 191,191,191,93,43,93,93,43,93,93,43,43,43,191,43,43,191,191,93,93,43,93,43,191,43,43,191,191,191,93,43
          db 93,93,43,93,43,191,43,43,191,43,43,191,191,93,93,43,43,191,191,43,43,191,191,191,93,43,93,93,93,43,43
          db 43,43,191,191,43,43,191,191,93,0,191,191,93,191,191,0,191,191,191,93,43,93,0,0,0,93,0,0,0,191,43,43,43
          db 191,191,0,0,0,93,0,0,0,191,191,191,6 dup (0),93,12 dup (0),93,6 dup (0)
  playerd_nums dw 13, 13

  playerl db 0,0,10 dup (191),43,0,0,191,43,191,43,191,43,191,43,191,43,191,0,0,191,9 dup (93),191,5 dup (0),5 dup (93)
          db 191,6 dup (0),93,93,43,43,43,93,93,191,5 dup (0),43,43,93,93,93,43,93,191,0,5 dup (93),43,93,43,43,191
          db 43,191,5 dup (0),191,43,43,191,191,191,43,191,5 dup (0),191,5 dup (43),191,191,6 dup (0),6 dup (191)
          db 0,0,0,0,93,10 dup (191),0,0,191,43,191,43,191,43,191,43,191,43,191,0,0,191,43,191,43,191,43,191,43,191
          db 43,1 dup (191)
  playerl_nums dw 13, 13

  playerr db 10 dup (191),43,0,0,191,43,191,43,191,43,191,43,191,43,191,0,0,191,9 dup (93),191,0,0,0,0,43,5 dup (93)
          db 6 dup (0),93,93,43,43,43,43,93,191,5 dup (0),93,43,93,93,93,43,43,191,5 dup (0),43,43,93,43,43,191,43
          db 5 dup (93),0,43,43,43,191,191,191,43,191,5 dup (0),43,191,5 dup (43),191,6 dup (0),6 dup (191),5 dup (0)
          db 93,10 dup (191),0,0,191,43,191,43,191,43,191,43,191,43,191,0,0,191,43,191,43,191,43,191,43,191,43,191
          db 2 dup (0)
  playerr_nums dw 13, 13

  playeru db 6 dup (0),93,12 dup (0),93,6 dup (0),93,191,191,0,0,0,93,0,0,0,93,191,191,93,43,93,0,0,0,93,0,0,0,191
          db 43,43,191,191,93,0,93,43,93,191,191,0,191,191,191,93,43,93,93,93,43,43,43,43,191,191,43,43,191,191,93
          db 93,43,93,93,43,43,43,191,191,191,93,43,93,93,43,93,43,191,43,43,191,43,43,191,191,93,93,43,93,43,191
          db 43,43,191,191,191,93,43,93,93,93,43,191,191,43,43,191,43,43,191,191,93,191,93,93,43,43,43,191,191,191
          db 191,93,43,93,0,5 dup (191),0,191,43,43,43,191,191,7 dup (0),3 dup (191)
  playeru_nums dw 13, 13

  preview db 15,7 dup (6),15,7 dup (6),15,7 dup (6),16 dup (0),15,7 dup (6),15,6,6,6,16 dup (0),6,6,6,6,15,7 dup (6)
          db 15,7 dup (6),15,6,6,6,8 dup (0),6,6,6,6,15,7 dup (6),15,7 dup (6),15,6,6,6,8 dup (0),6,6,6,6,15,6,6,6
          db 24 dup (0),6,6,6,6,15,7 dup (6),15,7 dup (6),15,6,6,6,15,7 dup (6),15,7 dup (6),15,7 dup (6),16 dup (0)
          db 15,7 dup (6),15,6,6,6,16 dup (0),6,6,6,6,15,7 dup (6),15,7 dup (6),15,6,6,6,8 dup (0),6,6,6,6,15,7 dup (6)
          db 15,7 dup (6),15,6,6,6,8 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,7 dup (6),15,7 dup (6),15,6,6
          db 6,15,7 dup (6),15,7 dup (6),15,7 dup (6),16 dup (0),15,7 dup (6),15,6,6,6,16 dup (0),6,6,6,6,15,7 dup (6)
          db 15,7 dup (6),15,6,6,6,8 dup (0),6,6,6,6,15,7 dup (6),15,7 dup (6),15,6,6,6,8 dup (0),6,6,6,6,15,6,6,6
          db 24 dup (0),6,6,6,6,15,7 dup (6),15,7 dup (6),15,6,6,6,24 dup (15),16 dup (0),12 dup (15),16 dup (0),24 dup (15)
          db 8 dup (0),24 dup (15),8 dup (0),8 dup (15),24 dup (0),24 dup (15),6,6,6,6,15,6,6,6,12 dup (0),15,7 dup (6)
          db 8 dup (0),15,7 dup (6),0,0,0,0,6,6,6,6,15,6,6,6,20 dup (0),15,7 dup (6),24 dup (0),15,7 dup (6),16 dup (0)
          db 15,7 dup (6),24 dup (0),15,7 dup (6),16 dup (0),6,6,6,6,15,6,6,6,12 dup (0),15,7 dup (6),8 dup (0),15
          db 7 dup (6),0,0,0,0,6,6,6,6,15,6,6,6,20 dup (0),15,7 dup (6),24 dup (0),15,7 dup (6),16 dup (0),15,7 dup (6)
          db 24 dup (0),15,7 dup (6),16 dup (0),6,6,6,6,15,6,6,6,12 dup (0),15,7 dup (6),8 dup (0),15,7 dup (6),0
          db 0,0,0,6,6,6,6,15,6,6,6,20 dup (0),15,7 dup (6),24 dup (0),15,7 dup (6),16 dup (0),15,7 dup (6),24 dup (0)
          db 15,7 dup (6),16 dup (0),8 dup (15),12 dup (0),8 dup (15),8 dup (0),8 dup (15),0,0,0,0,8 dup (15),20 dup (0)
          db 8 dup (15),24 dup (0),8 dup (15),16 dup (0),8 dup (15),24 dup (0),8 dup (15),16 dup (0),15,7 dup (6)
          db 12 dup (0),6,6,6,6,15,6,6,6,0,0,0,0,15,7 dup (6),12 dup (0),6,6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,6
          db 6,6,24 dup (0),6,6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,16 dup (0),15
          db 7 dup (6),12 dup (0),6,6,6,6,15,6,6,6,0,0,0,0,15,7 dup (6),12 dup (0),6,6,6,6,15,6,6,6,16 dup (0),6,6
          db 6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,16 dup (0)
          db 15,7 dup (6),12 dup (0),6,6,6,6,15,6,6,6,0,0,0,0,15,7 dup (6),12 dup (0),6,6,6,6,15,6,6,6,16 dup (0)
          db 6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6
          db 16 dup (0),8 dup (15),12 dup (0),8 dup (15),0,0,0,0,8 dup (15),12 dup (0),8 dup (15),16 dup (0),8 dup (15)
          db 24 dup (0),8 dup (15),16 dup (0),8 dup (15),24 dup (0),8 dup (15),16 dup (0),6,6,6,6,15,7 dup (6),15
          db 7 dup (6),15,6,6,6,8 dup (0),6,6,6,6,15,6,6,6,12 dup (0),15,7 dup (6),16 dup (0),15,7 dup (6),24 dup (0)
          db 15,7 dup (6),16 dup (0),15,7 dup (6),24 dup (0),15,7 dup (6),15,7 dup (6),15,6,6,6,0,0,0,0,6,6,6,6,15
          db 7 dup (6),15,7 dup (6),15,6,6,6,8 dup (0),6,6,6,6,15,6,6,6,12 dup (0),15,7 dup (6),16 dup (0),15,7 dup (6)
          db 24 dup (0),15,7 dup (6),16 dup (0),15,7 dup (6),24 dup (0),15,7 dup (6),15,7 dup (6),15,6,6,6,0,0,0,0
          db 6,6,6,6,15,7 dup (6),15,7 dup (6),15,6,6,6,8 dup (0),6,6,6,6,15,6,6,6,12 dup (0),15,7 dup (6),16 dup (0)
          db 15,7 dup (6),24 dup (0),15,7 dup (6),16 dup (0),15,7 dup (6),24 dup (0),15,7 dup (6),15,7 dup (6),15
          db 6,6,6,0,0,0,0,24 dup (15),8 dup (0),8 dup (15),12 dup (0),8 dup (15),16 dup (0),8 dup (15),24 dup (0)
          db 8 dup (15),16 dup (0),8 dup (15),24 dup (0),20 dup (15),0,0,0,0,15,7 dup (6),12 dup (0),6,6,6,6,15,6
          db 6,6,0,0,0,0,15,7 dup (6),15,7 dup (6),15,7 dup (6),15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6
          db 6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,16 dup (0),15,7 dup (6),12 dup (0)
          db 6,6,6,6,15,6,6,6,0,0,0,0,15,7 dup (6),15,7 dup (6),15,7 dup (6),15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6
          db 24 dup (0),6,6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,16 dup (0),15,7 dup (6)
          db 12 dup (0),6,6,6,6,15,6,6,6,0,0,0,0,15,7 dup (6),15,7 dup (6),15,7 dup (6),15,6,6,6,16 dup (0),6,6,6
          db 6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,16 dup (0)
          db 8 dup (15),12 dup (0),8 dup (15),0,0,0,0,28 dup (15),16 dup (0),8 dup (15),24 dup (0),8 dup (15),16 dup (0)
          db 8 dup (15),24 dup (0),8 dup (15),16 dup (0),6,6,6,6,15,6,6,6,12 dup (0),15,7 dup (6),0,0,0,0,6,6,6,6
          db 15,6,6,6,12 dup (0),15,7 dup (6),16 dup (0),15,7 dup (6),24 dup (0),15,7 dup (6),16 dup (0),15,7 dup (6)
          db 24 dup (0),15,7 dup (6),16 dup (0),6,6,6,6,15,6,6,6,12 dup (0),15,7 dup (6),0,0,0,0,6,6,6,6,15,6,6,6
          db 12 dup (0),15,7 dup (6),16 dup (0),15,7 dup (6),24 dup (0),15,7 dup (6),16 dup (0),15,7 dup (6),24 dup (0)
          db 15,7 dup (6),16 dup (0),6,6,6,6,15,6,6,6,12 dup (0),15,7 dup (6),0,0,0,0,6,6,6,6,15,6,6,6,12 dup (0)
          db 15,7 dup (6),16 dup (0),15,7 dup (6),24 dup (0),15,7 dup (6),16 dup (0),15,7 dup (6),24 dup (0),15,7 dup (6)
          db 16 dup (0),8 dup (15),12 dup (0),8 dup (15),0,0,0,0,8 dup (15),12 dup (0),8 dup (15),16 dup (0),8 dup (15)
          db 24 dup (0),8 dup (15),16 dup (0),8 dup (15),24 dup (0),8 dup (15),16 dup (0),15,7 dup (6),15,7 dup (6)
          db 15,7 dup (6),8 dup (0),15,7 dup (6),12 dup (0),6,6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6,24 dup (0)
          db 6,6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,7 dup (6),15,7 dup (6),15,6,6,6,8 dup (0),6,6,6,6,15,7 dup (6)
          db 15,7 dup (6),15,6,6,6,15,7 dup (6),15,7 dup (6),15,7 dup (6),8 dup (0),15,7 dup (6),12 dup (0),6,6,6
          db 6,15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,7 dup (6),15
          db 7 dup (6),15,6,6,6,8 dup (0),6,6,6,6,15,7 dup (6),15,7 dup (6),15,6,6,6,15,7 dup (6),15,7 dup (6),15
          db 7 dup (6),8 dup (0),15,7 dup (6),12 dup (0),6,6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6
          db 6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,7 dup (6),15,7 dup (6),15,6,6,6,8 dup (0),6,6,6,6,15,7 dup (6),15
          db 7 dup (6),15,6,6,6,24 dup (15),8 dup (0),8 dup (15),12 dup (0),8 dup (15),16 dup (0),8 dup (15),24 dup (0)
          db 8 dup (15),16 dup (0),24 dup (15),8 dup (0),24 dup (15),2300 dup (0),6,6,6,6,15,7 dup (6),15,6,6,6,12 dup (0)
          db 15,7 dup (6),15,7 dup (6),15,7 dup (6),8 dup (0),15,7 dup (6),15,7 dup (6),15,7 dup (6),8 dup (0),15
          db 7 dup (6),8 dup (0),15,7 dup (6),72 dup (0),6,6,6,6,15,7 dup (6),15,6,6,6,12 dup (0),15,7 dup (6),15
          db 7 dup (6),15,7 dup (6),8 dup (0),15,7 dup (6),15,7 dup (6),15,7 dup (6),8 dup (0),15,7 dup (6),8 dup (0)
          db 15,7 dup (6),72 dup (0),6,6,6,6,15,7 dup (6),15,6,6,6,12 dup (0),15,7 dup (6),15,7 dup (6),15,7 dup (6)
          db 8 dup (0),15,7 dup (6),15,7 dup (6),15,7 dup (6),8 dup (0),15,7 dup (6),8 dup (0),15,7 dup (6),72 dup (0)
          db 16 dup (15),12 dup (0),24 dup (15),8 dup (0),24 dup (15),8 dup (0),8 dup (15),8 dup (0),8 dup (15),68 dup (0)
          db 6,6,6,6,15,6,6,6,8 dup (0),6,6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,16 dup (0)
          db 6,6,6,6,15,6,6,6,8 dup (0),6,6,6,6,15,6,6,6,68 dup (0),6,6,6,6,15,6,6,6,8 dup (0),6,6,6,6,15,6,6,6,16 dup (0)
          db 6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6,8 dup (0),6,6,6,6,15,6,6,6,68 dup (0)
          db 6,6,6,6,15,6,6,6,8 dup (0),6,6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,16 dup (0)
          db 6,6,6,6,15,6,6,6,8 dup (0),6,6,6,6,15,6,6,6,68 dup (0),8 dup (15),8 dup (0),8 dup (15),16 dup (0),8 dup (15)
          db 24 dup (0),8 dup (15),16 dup (0),8 dup (15),8 dup (0),8 dup (15),64 dup (0),6,6,6,6,15,6,6,6,36 dup (0)
          db 15,7 dup (6),24 dup (0),15,7 dup (6),16 dup (0),15,7 dup (6),8 dup (0),15,7 dup (6),64 dup (0),6,6,6
          db 6,15,6,6,6,36 dup (0),15,7 dup (6),24 dup (0),15,7 dup (6),16 dup (0),15,7 dup (6),8 dup (0),15,7 dup (6)
          db 64 dup (0),6,6,6,6,15,6,6,6,36 dup (0),15,7 dup (6),24 dup (0),15,7 dup (6),16 dup (0),15,7 dup (6),8 dup (0)
          db 15,7 dup (6),64 dup (0),8 dup (15),36 dup (0),8 dup (15),24 dup (0),8 dup (15),16 dup (0),8 dup (15)
          db 8 dup (0),8 dup (15),64 dup (0),15,7 dup (6),36 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6
          db 20 dup (0),15,7 dup (6),15,7 dup (6),68 dup (0),15,7 dup (6),36 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6
          db 6,6,6,15,6,6,6,20 dup (0),15,7 dup (6),15,7 dup (6),68 dup (0),15,7 dup (6),36 dup (0),6,6,6,6,15,6,6
          db 6,24 dup (0),6,6,6,6,15,6,6,6,20 dup (0),15,7 dup (6),15,7 dup (6),68 dup (0),8 dup (15),36 dup (0),8 dup (15)
          db 24 dup (0),8 dup (15),20 dup (0),16 dup (15),68 dup (0),6,6,6,6,15,6,6,6,36 dup (0),15,7 dup (6),24 dup (0)
          db 15,7 dup (6),24 dup (0),15,7 dup (6),72 dup (0),6,6,6,6,15,6,6,6,36 dup (0),15,7 dup (6),24 dup (0),15
          db 7 dup (6),24 dup (0),15,7 dup (6),72 dup (0),6,6,6,6,15,6,6,6,36 dup (0),15,7 dup (6),24 dup (0),15,7 dup (6)
          db 24 dup (0),15,7 dup (6),72 dup (0),8 dup (15),36 dup (0),8 dup (15),24 dup (0),8 dup (15),24 dup (0)
          db 8 dup (15),76 dup (0),6,6,6,6,15,6,6,6,8 dup (0),6,6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6,24 dup (0)
          db 6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,76 dup (0),6,6,6,6,15,6,6,6,8 dup (0),6,6,6,6,15,6,6,6,16 dup (0)
          db 6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,76 dup (0),6,6,6,6,15,6,6,6
          db 8 dup (0),6,6,6,6,15,6,6,6,16 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6,15,6,6,6,24 dup (0),6,6,6,6
          db 15,6,6,6,76 dup (0),8 dup (15),8 dup (0),8 dup (15),16 dup (0),8 dup (15),24 dup (0),8 dup (15),24 dup (0)
          db 8 dup (15),80 dup (0),6,6,6,6,15,7 dup (6),15,6,6,6,12 dup (0),15,7 dup (6),15,7 dup (6),15,7 dup (6)
          db 16 dup (0),15,7 dup (6),24 dup (0),15,7 dup (6),80 dup (0),6,6,6,6,15,7 dup (6),15,6,6,6,12 dup (0),15
          db 7 dup (6),15,7 dup (6),15,7 dup (6),16 dup (0),15,7 dup (6),24 dup (0),15,7 dup (6),80 dup (0),6,6,6
          db 6,15,7 dup (6),15,6,6,6,12 dup (0),15,7 dup (6),15,7 dup (6),15,7 dup (6),16 dup (0),15,7 dup (6),24 dup (0)
          db 15,7 dup (6),80 dup (0),16 dup (15),12 dup (0),24 dup (15),16 dup (0),8 dup (15),24 dup (0),8 dup (15)
          db 3860 dup (0),15,15,11 dup (0),6 dup (15),0,0,0,15,15,7 dup (0),15,15,15,0,0,0,0,15,15,0,0,15,15,0,0,6 dup (15)
          db 0,6 dup (15),128 dup (0),15,15,15,11 dup (0),15,15,0,0,0,15,15,0,0,15,15,6 dup (0),15,15,0,15,15,0,0
          db 0,15,15,0,0,15,15,0,0,15,15,5 dup (0),15,15,0,0,0,15,15,128 dup (0),15,15,11 dup (0),15,15,0,0,0,15,15
          db 0,0,15,15,5 dup (0),15,15,0,0,0,15,15,0,0,15,15,0,0,15,15,0,0,15,15,5 dup (0),15,15,0,0,0,15,15,128 dup (0)
          db 15,15,11 dup (0),15,15,0,0,0,15,15,0,0,15,15,5 dup (0),15,15,0,0,0,15,15,0,0,0,15,15,15,15,0,0,0,5 dup (15)
          db 0,0,15,15,0,0,15,15,15,128 dup (0),15,15,11 dup (0),6 dup (15),0,0,0,15,15,5 dup (0),7 dup (15),0,0,0
          db 0,15,15,0,0,0,0,15,15,5 dup (0),5 dup (15),130 dup (0),15,15,11 dup (0),15,15,7 dup (0),15,15,5 dup (0)
          db 15,15,0,0,0,15,15,0,0,0,0,15,15,0,0,0,0,15,15,5 dup (0),15,15,0,15,15,15,127 dup (0),6 dup (15),9 dup (0)
          db 15,15,7 dup (0),6 dup (15),0,15,15,0,0,0,15,15,0,0,0,0,15,15,0,0,0,0,6 dup (15),0,15,15,0,0,15,15,15
          db 1818 dup (0),5 dup (15),10 dup (0),6 dup (15),0,0,0,15,15,7 dup (0),15,15,15,0,0,0,0,15,15,0,0,15,15
          db 0,0,6 dup (15),0,6 dup (15),0,0,0,15,15,15,15,119 dup (0),15,15,0,0,0,15,15,9 dup (0),15,15,0,0,0,15
          db 15,0,0,15,15,6 dup (0),15,15,0,15,15,0,0,0,15,15,0,0,15,15,0,0,15,15,5 dup (0),15,15,0,0,0,15,15,0,15
          db 15,0,0,15,15,122 dup (0),15,15,15,9 dup (0),15,15,0,0,0,15,15,0,0,15,15,5 dup (0),15,15,0,0,0,15,15,0
          db 0,15,15,0,0,15,15,0,0,15,15,5 dup (0),15,15,0,0,0,15,15,0,15,15,124 dup (0),15,15,15,15,10 dup (0),15
          db 15,0,0,0,15,15,0,0,15,15,5 dup (0),15,15,0,0,0,15,15,0,0,0,15,15,15,15,0,0,0,5 dup (15),0,0,15,15,0,0
          db 15,15,15,0,0,5 dup (15),119 dup (0),15,15,15,15,11 dup (0),6 dup (15),0,0,0,15,15,5 dup (0),7 dup (15)
          db 0,0,0,0,15,15,0,0,0,0,15,15,5 dup (0),5 dup (15),8 dup (0),15,15,117 dup (0),15,15,15,13 dup (0),15,15
          db 7 dup (0),15,15,5 dup (0),15,15,0,0,0,15,15,0,0,0,0,15,15,0,0,0,0,15,15,5 dup (0),15,15,0,15,15,15,0
          db 0,15,15,0,0,0,15,15,117 dup (0),7 dup (15),9 dup (0),15,15,7 dup (0),6 dup (15),0,15,15,0,0,0,15,15,0
          db 0,0,0,15,15,0,0,0,0,6 dup (15),0,15,15,0,0,15,15,15,0,0,5 dup (15),57 dup (0)
  preview_nums dw 188, 111

  stage db 22,22,0,0,0,0,22,22,22,22,6 dup (0),22,22,22,0,0,0,5 dup (22),5 dup (0),22,22,6 dup (0),22,22,0,0,22
        db 22,0,0,5 dup (22),0,0,22,22,22,22,0,0,22,0,0,22,22,22,0,0,6 dup (22),0,0,6 dup (22),0,0,9 dup (22),0
        db 0,22,22,22,0,0,22,22,22,0,0,22,0,0,7 dup (22),0,0,7 dup (22),5 dup (0),5 dup (22),0,0,22,22,22,0,0,22
        db 22,22,0,0,22,0,0,22,22,0,0,0,22,22,5 dup (0),8 dup (22),0,0,22,22,22,22,0,0,22,22,22,7 dup (0),22,0,0
        db 22,22,22,0,0,22,22,0,0,6 dup (22),0,0,22,22,22,0,0,22,22,22,22,0,0,22,22,22,0,0,22,22,22,0,0,22,22,0
        db 0,22,22,0,0,22,22,0,0,7 dup (22),5 dup (0),5 dup (22),0,0,22,22,22,0,0,22,22,22,0,0,22,22,22,5 dup (0)
        db 22,22,6 dup (0),42 dup (22)
  stage_nums dw 41, 8

; ------- SOUNDS -------

  lvl_start dw lvl_start_beat, lvl_start_sound
  lvl_start_beat db 2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,2,2,4,1,1,1,1,1,1,1
  lvl_start_sound db 24,0,26,0,27,0,24,0,26,0,27,0,27,0,29,0,31,0,27,0,29,0,31,0,29,0,31,0,33,0,29,0,31,0,33,0,32,0,35,0
                  db 36,0,28,0,28,0,28,0,28,0,28,0ffh

end start